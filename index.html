<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 é¦¬ä¹‹å¹´æ–°æ˜¥è¨ˆç•« - è¨‚å–®ç³»çµ±</title>
    <style>
        :root { 
            --red: #b22222; /* æœ±ç ‚ç´… */
            --gold: #d4af37; /* å¯Œè²´é‡‘ */
            --bg: #fdf5e6; /* è€å®£ç´™è‰² */
            --text: #2c2c2c;
        }

        body { 
            font-family: "Microsoft JhengHei", "PingFang TC", serif; 
            background-color: var(--bg); 
            background-image: radial-gradient(var(--gold) 0.5px, transparent 0.5px);
            background-size: 30px 30px; /* å¾®å°çš„è£é£¾é» */
            margin: 0; 
            color: var(--text);
            text-align: center; 
        }

        /* é ‚éƒ¨å°èˆª - ä¸­åœ‹é¢¨æ²è»¸æ„Ÿ */
        .nav { 
            background: var(--red); 
            padding: 20px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
            border-bottom: 4px solid var(--gold);
        }

        .nav button { 
            padding: 12px 25px; 
            margin: 0 10px; 
            cursor: pointer; 
            border: 2px solid var(--gold); 
            background: transparent; 
            color: var(--gold); 
            border-radius: 0px; /* æ–¹æ­£é¡¯å¾—èŠé‡ */
            font-size: 18px;
            font-weight: bold;
            transition: 0.3s;
        }

        .nav button.active { 
            background: var(--gold); 
            color: var(--red); 
        }

        .nav button:hover {
            background: rgba(212, 175, 55, 0.2);
        }

        /* å…§å®¹å®¹å™¨ - å¢åŠ å¯¬åº¦èˆ‡é«˜åº¦ */
        .container { 
            max-width: 900px; /* å¯¬åº¦åŠ å¯¬ä»¥å®¹ç´è¡¨å–® */
            margin: 30px auto; 
            padding: 0 20px; 
        }

        /* éš±è—æ²è»¸çš„é—œéµï¼šå¢åŠ  iframe é«˜åº¦ */
        #form-box {
            width: 100%;
            overflow: hidden; /* é˜²æ­¢çˆ¶å®¹å™¨å‡ºç¾æ²è»¸ */
            background: #fff;
            border: 8px double var(--gold); /* é›™é‚Šæ¡† */
            border-radius: 4px;
        }

        iframe {
            display: block;
            width: 100%;
            height: 1250px; /* å¤§å¹…å¢åŠ é«˜åº¦ä»¥å®Œæ•´é¡¯ç¤º Google Form */
            border: none;
        }

        /* æŸ¥è©¢å¡ç‰‡ç¾åŒ– */
        .card { 
            background: #fff; 
            padding: 40px 25px; 
            border: 2px solid var(--red);
            border-radius: 0px; 
            box-shadow: 10px 10px 0px var(--gold); /* å¾©å¤é™°å½± */
            position: relative;
        }

        .card h3 {
            color: var(--red);
            font-size: 24px;
            margin-top: 0;
            border-bottom: 1px solid var(--gold);
            display: inline-block;
            padding-bottom: 5px;
        }

        input { 
            width: 80%; 
            padding: 15px; 
            margin: 20px 0; 
            border: 1px solid var(--gold); 
            background: #fff;
            font-size: 18px; 
            text-align: center;
        }

        .btn-send { 
            background: var(--red); 
            color: var(--gold); 
            border: none; 
            padding: 15px 40px; 
            cursor: pointer; 
            width: 85%; 
            font-size: 20px; 
            font-weight: bold;
            box-shadow: 0 4px 0px #7b1818;
        }

        .btn-send:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        #resultArea { margin-top: 30px; text-align: left; }

        .item { 
            display: flex; 
            justify-content: space-between; 
            padding: 15px; 
            border-bottom: 1px dashed var(--gold); 
        }

        .item span { color: #666; font-size: 14px; }
        .item b { color: var(--red); font-size: 16px; }

        #loading { display: none; margin: 15px; color: var(--red); font-weight: bold; }

        /* é‡å°æ‰‹æ©Ÿå„ªåŒ– */
        @media (max-width: 600px) {
            .container { padding: 0 10px; }
            iframe { height: 1600px; } /* æ‰‹æ©Ÿç‰ˆè¡¨å–®é€šå¸¸æœƒæ‹‰æ›´é•· */
            .nav button { padding: 8px 15px; font-size: 16px; margin: 0 5px; }
        }
    </style>
</head>
<body>

<div class="nav">
    <button id="tab1" class="active" onclick="show('form')">ğŸ§§ å¡«å¯«è¨‚è³¼å–®</button>
    <button id="tab2" onclick="show('query')">ğŸ“œ è¨‚å–®æŸ¥è©¢</button>
</div>

<div class="container">
    <div id="form-box">
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdXlk7EdJkupKMgFA6zgDUkhw622IXwkYvx5yJGfkaMhRe1ZQ/viewform?embedded=true">è¼‰å…¥ä¸­â€¦</iframe>
    </div>

    <div id="query-box" style="display:none;">
        <div class="card">
            <h3>æ–°å¹´è¨‚å–®æª¢ç´¢</h3>
            <p style="color: #888;">è«‹è¼¸å…¥ã€ŒåŒ¯æ¬¾å¸³è™Ÿå¾Œäº”ç¢¼ã€ä»¥ä¾›æ ¸å°</p>
            <input type="text" id="code" placeholder="äº”ä½æ•¸å­—" maxlength="5" inputmode="numeric">
            <br>
            <button class="btn-send" onclick="doSearch()">æŸ¥è©¢è¨‚å–®ç‹€æ…‹</button>
            <div id="loading">ğŸ® æ­£ç‚ºæ‚¨ç¿»é–±å¸³å†Š...</div>
            <div id="resultArea"></div>
        </div>
    </div>
</div>

<script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyD5ToaxS_kZlFnwlXjuu7Kn9hmN2DFXQTiv2rx7WHT7K_4PIOlaCUqJlxzW_F1R7XL/exec";

    function show(type) {
        document.getElementById('form-box').style.display = type === 'form' ? 'block' : 'none';
        document.getElementById('query-box').style.display = type === 'query' ? 'block' : 'none';
        document.getElementById('tab1').className = type === 'form' ? 'active' : '';
        document.getElementById('tab2').className = type === 'query' ? 'active' : '';
        // åˆ‡æ›æ™‚å›åˆ°é ‚éƒ¨
        window.scrollTo(0, 0);
    }

    async function doSearch() {
        const code = document.getElementById('code').value.trim();
        if(code.length < 5) return alert("è«‹è¼¸å…¥å®Œæ•´çš„ 5 ä½æ•¸å­—");

        const loading = document.getElementById('loading');
        const resDiv = document.getElementById('resultArea');
        
        loading.style.display = 'block';
        resDiv.innerHTML = '';

        try {
            const finalUrl = `${API_URL}?code=${code}`;
            const response = await fetch(finalUrl, { method: 'GET' });
            const result = await response.json();

            if(result.status === 'success') {
                resDiv.innerHTML = result.data.map(i => `
                    <div class="item">
                        <span>${i.label}</span>
                        <b>${(i.value !== "" && i.value !== null) ? i.value : "ç„¡"}</b>
                    </div>
                `).join('');
            } else {
                alert("æŸ¥ç„¡è³‡æ–™ï¼šè«‹ç¢ºèªå¾Œäº”ç¢¼æ˜¯å¦æ­£ç¢ºï¼Œæˆ–å°šæœªå…¥å¸³ã€‚");
            }
        } catch (e) {
            console.error(e);
            alert("ç³»çµ±ç¹å¿™ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
        } finally {
            loading.style.display = 'none';
        }
    }
</script>
</body>
</html>
